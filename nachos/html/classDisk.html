<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nachos: Disk Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Nachos
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classDisk-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Disk Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="disk_8h_source.html">disk.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Disk:</div>
<div class="dyncontent">
<div class="center"><img src="classDisk__coll__graph.png" border="0" usemap="#aDisk_coll__map" alt="Collaboration graph"/></div>
<map name="aDisk_coll__map" id="aDisk_coll__map">
<area shape="rect" title="Defines a physical disk I/O device." alt="" coords="5,5,155,311"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af255e1823d23c1cff4495263ca1096b3" id="r_af255e1823d23c1cff4495263ca1096b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#af255e1823d23c1cff4495263ca1096b3">Disk</a> (<a class="el" href="classListElement.html">char</a> *name, <a class="el" href="libnachos_8h.html#a9c6f12cbff87535a17c52ca7d975f2a5">VoidNoArgFunctionPtr</a> <a class="el" href="classListElement.html">callWhenDone</a>)</td></tr>
<tr class="separator:af255e1823d23c1cff4495263ca1096b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77518c808f3f5d9e902a55942542c337" id="r_a77518c808f3f5d9e902a55942542c337"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a77518c808f3f5d9e902a55942542c337">~Disk</a> ()</td></tr>
<tr class="separator:a77518c808f3f5d9e902a55942542c337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b51a82d4f2fd009335d0c591ae11042" id="r_a8b51a82d4f2fd009335d0c591ae11042"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a8b51a82d4f2fd009335d0c591ae11042">ReadRequest</a> (<a class="el" href="classListElement.html">int</a> <a class="el" href="classListElement.html">sectorNumber</a>, <a class="el" href="classListElement.html">char</a> *<a class="el" href="classListElement.html">data</a>)</td></tr>
<tr class="separator:a8b51a82d4f2fd009335d0c591ae11042"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec33797c6480a8c919fc7d340c316abe" id="r_aec33797c6480a8c919fc7d340c316abe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#aec33797c6480a8c919fc7d340c316abe">WriteRequest</a> (<a class="el" href="classListElement.html">int</a> <a class="el" href="classListElement.html">sectorNumber</a>, <a class="el" href="classListElement.html">char</a> *<a class="el" href="classListElement.html">data</a>)</td></tr>
<tr class="separator:aec33797c6480a8c919fc7d340c316abe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32d4a38e61501c221163ef845b9d6969" id="r_a32d4a38e61501c221163ef845b9d6969"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a32d4a38e61501c221163ef845b9d6969">HandleInterrupt</a> ()</td></tr>
<tr class="separator:a32d4a38e61501c221163ef845b9d6969"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2337b1c68eb5f6a15502d8327d15248b" id="r_a2337b1c68eb5f6a15502d8327d15248b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a2337b1c68eb5f6a15502d8327d15248b">ComputeLatency</a> (<a class="el" href="classListElement.html">int</a> <a class="el" href="classListElement.html">newSector</a>, <a class="el" href="classListElement.html">bool</a> <a class="el" href="classListElement.html">writing</a>)</td></tr>
<tr class="separator:a2337b1c68eb5f6a15502d8327d15248b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:abecdf19e160925b1bc9b4542c90de2ac" id="r_abecdf19e160925b1bc9b4542c90de2ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#abecdf19e160925b1bc9b4542c90de2ac">TimeToSeek</a> (<a class="el" href="classListElement.html">int</a> <a class="el" href="classListElement.html">newSector</a>, <a class="el" href="classListElement.html">int</a> *<a class="el" href="classListElement.html">rotate</a>)</td></tr>
<tr class="separator:abecdf19e160925b1bc9b4542c90de2ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf14ace693df2b08e1187045305e81a5" id="r_abf14ace693df2b08e1187045305e81a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#abf14ace693df2b08e1187045305e81a5">ModuloDiff</a> (<a class="el" href="classListElement.html">int</a> <a class="el" href="classListElement.html">to</a>, <a class="el" href="utility_8h.html#a404f45f62799218047ab2cfe96f408d5">Time</a> <a class="el" href="classListElement.html">from</a>)</td></tr>
<tr class="separator:abf14ace693df2b08e1187045305e81a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87426eeedc8cf390fa4b293ecd34b42" id="r_aa87426eeedc8cf390fa4b293ecd34b42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#aa87426eeedc8cf390fa4b293ecd34b42">UpdateLast</a> (<a class="el" href="classListElement.html">int</a> <a class="el" href="classListElement.html">newSector</a>)</td></tr>
<tr class="separator:aa87426eeedc8cf390fa4b293ecd34b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a27881148b34cffd7005df5d7353ce775" id="r_a27881148b34cffd7005df5d7353ce775"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a27881148b34cffd7005df5d7353ce775">fileno</a></td></tr>
<tr class="separator:a27881148b34cffd7005df5d7353ce775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c18ccdc11e90056f005dfc68df677f3" id="r_a0c18ccdc11e90056f005dfc68df677f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="libnachos_8h.html#a9c6f12cbff87535a17c52ca7d975f2a5">VoidNoArgFunctionPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a0c18ccdc11e90056f005dfc68df677f3">handler</a></td></tr>
<tr class="separator:a0c18ccdc11e90056f005dfc68df677f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41ece24e9dead4ad0af20607d3ac4934" id="r_a41ece24e9dead4ad0af20607d3ac4934"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a41ece24e9dead4ad0af20607d3ac4934">active</a></td></tr>
<tr class="separator:a41ece24e9dead4ad0af20607d3ac4934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09339a72e2d38a32238934f0ae2ae1bb" id="r_a09339a72e2d38a32238934f0ae2ae1bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classListElement.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a09339a72e2d38a32238934f0ae2ae1bb">lastSector</a></td></tr>
<tr class="separator:a09339a72e2d38a32238934f0ae2ae1bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de9a24527782fe0ad3bad8096951077" id="r_a1de9a24527782fe0ad3bad8096951077"><td class="memItemLeft" align="right" valign="top"><a class="el" href="utility_8h.html#a404f45f62799218047ab2cfe96f408d5">Time</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDisk.html#a1de9a24527782fe0ad3bad8096951077">bufferInit</a></td></tr>
<tr class="separator:a1de9a24527782fe0ad3bad8096951077"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a physical disk I/O device. </p>
<p>The disk has a single surface, split up into "tracks", and each track split up into "sectors" (the same number of sectors on each track, and each sector has the same number of bytes of storage). <br  />
</p>
<p>Addressing is by sector number &ndash; each sector on the disk is given a unique number: track * SectorsPerTrack + offset within a track.</p>
<p>As with other I/O devices, the physical disk is an asynchronous device &ndash; requests to read or write portions of the disk return immediately, and an interrupt is invoked later to signal that the operation completed.</p>
<p>The physical disk is in fact simulated via operations on a UNIX file.</p>
<p>To make life a little more realistic, the simulated time for each operation reflects a "track buffer" &ndash; RAM to store the contents of the current track as the disk head passes by. The idea is that the disk always transfers to the track buffer, in case that data is requested later on. This has the benefit of eliminating the need for "skip-sector" scheduling &ndash; a read request which comes in shortly after the head has passed the beginning of the sector can be satisfied more quickly, because its contents are in the track buffer. Most disks these days now come with a track buffer.</p>
<p>The track buffer simulation can be disabled by compiling with -DNOTRACKBUF </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af255e1823d23c1cff4495263ca1096b3" name="af255e1823d23c1cff4495263ca1096b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af255e1823d23c1cff4495263ca1096b3">&#9670;&#160;</a></span>Disk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Disk::Disk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">char</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libnachos_8h.html#a9c6f12cbff87535a17c52ca7d975f2a5">VoidNoArgFunctionPtr</a>&#160;</td>
          <td class="paramname"><em>callWhenDone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a simulated disk. <br  />
 Invoke (*callWhenDone) every time a request completes.</p>
<p>Constructor. Initialize a simulated disk. <br  />
 Open the UNIX file (creating it if it doesn't exist), and check the magic number to make sure it's OK to treat it as Nachos disk storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>text name of the file simulating the Nachos disk </td></tr>
    <tr><td class="paramname">callWhenDone</td><td>interrupt handler to be called when disk read/write request completes </td></tr>
    <tr><td class="paramname">callArg</td><td>argument to pass the interrupt handler </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a77518c808f3f5d9e902a55942542c337" name="a77518c808f3f5d9e902a55942542c337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77518c808f3f5d9e902a55942542c337">&#9670;&#160;</a></span>~Disk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Disk::~Disk </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Deallocate the disk.</p>
<p>Destructor. Clean up disk simulation, by closing the UNIX file representing the disk. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2337b1c68eb5f6a15502d8327d15248b" name="a2337b1c68eb5f6a15502d8327d15248b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2337b1c68eb5f6a15502d8327d15248b">&#9670;&#160;</a></span>ComputeLatency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">int</a> Disk::ComputeLatency </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a>&#160;</td>
          <td class="paramname"><em>newSector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classListElement.html">bool</a>&#160;</td>
          <td class="paramname"><em>writing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return how long a request to newSector will take: (seek + rotational delay + transfer)</p>
<p>Return how long will it take to read/write a disk sector, from the current position of the disk head.</p>
<p>Latency = seek time + rotational latency + transfer time <a class="el" href="classDisk.html" title="Defines a physical disk I/O device.">Disk</a> seeks at one track per SEEK_TIME nanos (cf. <a class="el" href="classListElement.html#afc3cc3f75c7b66aca68c64c61f7c034f">stats.h</a>) and rotates at one sector per ROTATION_TIME nanos</p>
<p>To find the rotational latency, we first must figure out where the disk head will be after the seek (if any). We then figure out how long it will take to rotate completely past newSector after that point.</p>
<p>The disk also has a "track buffer"; the disk continuously reads the contents of the current disk track into the buffer. This allows read requests to the current track to be satisfied more quickly. The contents of the track buffer are discarded after every seek to a new track. </p>

</div>
</div>
<a id="a32d4a38e61501c221163ef845b9d6969" name="a32d4a38e61501c221163ef845b9d6969"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32d4a38e61501c221163ef845b9d6969">&#9670;&#160;</a></span>HandleInterrupt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">void</a> Disk::HandleInterrupt </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><a class="el" href="classInterrupt.html" title="Defines a low level interrupt hardware.">Interrupt</a> handler, invoked when disk request finishes.</p>
<p>Called when it is time to invoke the disk interrupt handler, to tell the Nachos kernel that the disk request is done. </p>

</div>
</div>
<a id="abf14ace693df2b08e1187045305e81a5" name="abf14ace693df2b08e1187045305e81a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf14ace693df2b08e1187045305e81a5">&#9670;&#160;</a></span>ModuloDiff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">int</a> Disk::ModuloDiff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a>&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="utility_8h.html#a404f45f62799218047ab2cfe96f408d5">Time</a>&#160;</td>
          <td class="paramname"><em>from</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return number of sectors of rotational delay between target sector "to" and current sector position "from" </p>

</div>
</div>
<a id="a8b51a82d4f2fd009335d0c591ae11042" name="a8b51a82d4f2fd009335d0c591ae11042"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b51a82d4f2fd009335d0c591ae11042">&#9670;&#160;</a></span>ReadRequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">void</a> Disk::ReadRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a>&#160;</td>
          <td class="paramname"><em>sectorNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classListElement.html">char</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read/write an single disk sector. These routines send a request to the disk and return immediately. Only one request allowed at a time!</p>
<p>Simulate a request to read a single disk sector Do the read immediately to the UNIX file Set up an interrupt handler to be called later, that will notify the caller when the simulator says the operation has completed.</p>
<p>Note that a disk only allows an entire sector to be read, not part of a sector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sectorNumber</td><td>the disk sector to read </td></tr>
    <tr><td class="paramname">data</td><td>the buffer to hold the incoming bytes </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abecdf19e160925b1bc9b4542c90de2ac" name="abecdf19e160925b1bc9b4542c90de2ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abecdf19e160925b1bc9b4542c90de2ac">&#9670;&#160;</a></span>TimeToSeek()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">int</a> Disk::TimeToSeek </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a>&#160;</td>
          <td class="paramname"><em>newSector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a> *&#160;</td>
          <td class="paramname"><em>rotation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns how long it will take to position the disk head over the correct track on the disk. Since when we finish seeking, we are likely to be in the middle of a sector that is rotating past the head, we also return how long until the head is at the next sector boundary.</p>
<p><a class="el" href="classDisk.html" title="Defines a physical disk I/O device.">Disk</a> seeks at one track per SEEK_TIME nanos (cf. <a class="el" href="classListElement.html#afc3cc3f75c7b66aca68c64c61f7c034f">stats.h</a>) and rotates at one sector per ROTATION_TIME nanos </p>

</div>
</div>
<a id="aa87426eeedc8cf390fa4b293ecd34b42" name="aa87426eeedc8cf390fa4b293ecd34b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa87426eeedc8cf390fa4b293ecd34b42">&#9670;&#160;</a></span>UpdateLast()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">void</a> Disk::UpdateLast </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a>&#160;</td>
          <td class="paramname"><em>newSector</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Keep track of the most recently requested sector. So we can know what is in the track buffer. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">newSector</td><td>accessed sector </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aec33797c6480a8c919fc7d340c316abe" name="aec33797c6480a8c919fc7d340c316abe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec33797c6480a8c919fc7d340c316abe">&#9670;&#160;</a></span>WriteRequest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">void</a> Disk::WriteRequest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classListElement.html">int</a>&#160;</td>
          <td class="paramname"><em>sectorNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classListElement.html">char</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Simulate a request to write a single disk sector Do the write immediately to the UNIX file Set up an interrupt handler to be called later, that will notify the caller when the simulator says the operation has completed.</p>
<p>Note that a disk only allows an entire sector to be written, not part of a sector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sectorNumber</td><td>the disk sector to write </td></tr>
    <tr><td class="paramname">data</td><td>the bytes to be written </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a41ece24e9dead4ad0af20607d3ac4934" name="a41ece24e9dead4ad0af20607d3ac4934"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41ece24e9dead4ad0af20607d3ac4934">&#9670;&#160;</a></span>active</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">bool</a> Disk::active</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Is a disk operation in progress? </p>

</div>
</div>
<a id="a1de9a24527782fe0ad3bad8096951077" name="a1de9a24527782fe0ad3bad8096951077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1de9a24527782fe0ad3bad8096951077">&#9670;&#160;</a></span>bufferInit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="utility_8h.html#a404f45f62799218047ab2cfe96f408d5">Time</a> Disk::bufferInit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>being loaded </p>
<p>When the track buffer started <br  />
 </p>

</div>
</div>
<a id="a27881148b34cffd7005df5d7353ce775" name="a27881148b34cffd7005df5d7353ce775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27881148b34cffd7005df5d7353ce775">&#9670;&#160;</a></span>fileno</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">int</a> Disk::fileno</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>UNIX file number for simulated disk. </p>

</div>
</div>
<a id="a0c18ccdc11e90056f005dfc68df677f3" name="a0c18ccdc11e90056f005dfc68df677f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c18ccdc11e90056f005dfc68df677f3">&#9670;&#160;</a></span>handler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="libnachos_8h.html#a9c6f12cbff87535a17c52ca7d975f2a5">VoidNoArgFunctionPtr</a> Disk::handler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classInterrupt.html" title="Defines a low level interrupt hardware.">Interrupt</a> handler, to be invoked when any disk request finishes </p>

</div>
</div>
<a id="a09339a72e2d38a32238934f0ae2ae1bb" name="a09339a72e2d38a32238934f0ae2ae1bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09339a72e2d38a32238934f0ae2ae1bb">&#9670;&#160;</a></span>lastSector</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classListElement.html">int</a> Disk::lastSector</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The previous disk request. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>machine/<a class="el" href="disk_8h_source.html">disk.h</a></li>
<li>machine/<a class="el" href="disk_8cc.html">disk.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
